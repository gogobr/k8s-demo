# ç»§æ‰¿é€šç”¨æ¨¡æ¿çš„æ‰€æœ‰é…ç½®
image:
  repository: mengxu46/k8s-gateway
  tag: "eac11ec260c2a8e11b562dcd1b17188d99b595a2" # CI ä¼šæ”¹è¿™ä¸ª
mysql:
  host: "mycluster.middleware.svc.cluster.local"
  port: 6446
# ç¯å¢ƒå˜é‡ (è¿æ¥ Nacos)
env:
  # è¿™é‡Œçš„ Key å¿…é¡»å’Œä½  bootstrap.yml é‡Œ ${} å†™çš„åå­—ä¸€æ¨¡ä¸€æ ·
  NACOS_SERVER_ADDR: "nacos.middleware.svc.cluster.local:8848"
  # WebFlux åº”ç”¨ä¸éœ€è¦ context-pathï¼Œä½†å¯èƒ½éœ€è¦é… Netty ç›¸å…³å‚æ•°
  JAVA_OPTS: "-Xms256m -Xmx512m"
  # ... å…¶ä»–å˜é‡ ...
  # ... å…¶ä»–å˜é‡ ...
  # ğŸ”¥ è®©é™æµè¿‡æ»¤å™¨æ‰“å°æ—¥å¿—
  logging.level.org.springframework.cloud.gateway.filter.ratelimit: DEBUG
  # ğŸ”¥ è®© Redis å“åº”å¼è¿æ¥æ‰“å°æ—¥å¿—
  logging.level.org.springframework.data.redis: DEBUG
# Service å®šä¹‰
service:
  type: ClusterIP
  port: 8080
# Ingress å®šä¹‰ (ç½‘å…³ç‹¬äº«å…¥å£)
ingress:
  enabled: true
  className: "nginx"
  hosts:
    - host: backend.local # ä»¥ååç«¯æ¥å£éƒ½èµ°è¿™ä¸ªåŸŸåè¿›ç½‘å…³
      paths:
        - path: /
          pathType: Prefix
          serviceName: k8s-gateway # å¼ºåˆ¶æŒ‡å‘ç½‘å…³
          servicePort: 8080
autoscaling:
  enabled: true
  minReplicas: 1
  maxReplicas: 10
  # å…³é”®ä¿®æ”¹ï¼šä¸ºäº†æ¼”ç¤ºæ•ˆæœï¼Œæˆ‘ä»¬æš‚æ—¶æŠŠ CPU é˜ˆå€¼è®¾ä¸º 1%
  # åªè¦ K6 ä¸€è·‘ï¼Œç«‹åˆ»å°±èƒ½è§¦å‘æ‰©å®¹ï¼Œä¸ç”¨ç­‰ CPU çœŸçš„æ‰“æ»¡
  targetCPUUtilizationPercentage: 1
  # å¦‚æœæœ‰ memory é…ç½®ï¼Œä¹Ÿå¯ä»¥åŠ ä¸Šï¼Œä½† CPU æœ€ç›´è§‚
  # targetMemoryUtilizationPercentage: 80
# èµ„æºé™åˆ¶ (ç½‘å…³æ˜¯ CPU å¯†é›†å‹ï¼Œç»™å¤Ÿ CPU)
resources:
  limits:
    cpu: 1000m
    memory: 512Mi
  requests:
    cpu: 100m
    memory: 256Mi
